{
  "version": 1,
  "description": "Future features for Claude SDK - Advanced API capabilities",
  "features": [
    {
      "id": "SDK018",
      "name": "Extended Thinking Support",
      "description": "Support for Claude's extended thinking feature where the model shows its reasoning process. Requires anthropic-beta: thinking-2025-12-05 header.",
      "priority": 2,
      "status": "planned",
      "dependencies": ["SDK005"],
      "notes": [
        "Add thinking content blocks in streaming responses",
        "Track thinking tokens separately in usage",
        "Add enable_thinking field to MessagesRequest",
        "Example showing reasoning process visualization"
      ]
    },
    {
      "id": "SDK019",
      "name": "Vision Support (Images)",
      "description": "Support for image inputs in messages. Claude 4.5+ models support vision.",
      "priority": 2,
      "status": "planned",
      "dependencies": ["SDK002"],
      "notes": [
        "Add Image content block type",
        "Support base64 encoded images",
        "Support image URLs",
        "Add image source types (base64, url)",
        "Media types: image/jpeg, image/png, image/gif, image/webp",
        "Example with image analysis"
      ]
    },
    {
      "id": "SDK020",
      "name": "Structured Outputs (JSON Schema)",
      "description": "Force Claude to return structured JSON matching a schema. Uses tool_choice parameter.",
      "priority": 3,
      "status": "planned",
      "dependencies": ["SDK006"],
      "notes": [
        "Add tool_choice field to MessagesRequest",
        "Support tool_choice: {type: 'tool', name: 'tool_name'}",
        "Support tool_choice: {type: 'any'} and {type: 'auto'}",
        "Example showing forced JSON output",
        "Useful for data extraction, form filling"
      ]
    },
    {
      "id": "SDK021",
      "name": "Batch API Support",
      "description": "Support for Claude's batch API for processing multiple requests asynchronously at 50% cost.",
      "priority": 3,
      "status": "planned",
      "dependencies": ["SDK001"],
      "notes": [
        "New endpoint: POST /v1/messages/batches",
        "Batch creation, status checking, result retrieval",
        "24-hour processing window",
        "50% discount on batch requests",
        "Separate BatchClient or add to ClaudeClient",
        "Example showing batch job creation and polling"
      ]
    },
    {
      "id": "SDK022",
      "name": "PDF Support",
      "description": "Support for PDF document analysis via vision API. Extract text, analyze layout, answer questions about PDFs.",
      "priority": 4,
      "status": "planned",
      "dependencies": ["SDK019"],
      "notes": [
        "Convert PDF pages to images",
        "Use pdf-rs or similar for rendering",
        "Send as image content blocks",
        "Helper: send_pdf_message(pdf_path, question)",
        "Example: PDF invoice extraction"
      ]
    },
    {
      "id": "SDK023",
      "name": "Embeddings Support (Voyage AI Integration)",
      "description": "First-class embeddings support via Voyage AI integration. Anthropic recommends Voyage AI for embeddings.",
      "priority": 2,
      "status": "planned",
      "dependencies": ["SDK001"],
      "notes": [
        "Anthropic recommends Voyage AI (doesn't offer own embeddings)",
        "Implement VoyageClient with embed() method",
        "Models: voyage-3-large, voyage-3.5, voyage-3.5-lite, voyage-code-3",
        "Domain-specific: voyage-finance-2, voyage-law-2",
        "Multimodal: voyage-multimodal-3 (text + images)",
        "Features: Matryoshka (truncatable), quantization (int8, binary)",
        "Use cases: RAG, semantic search, clustering, recommendations",
        "Optional feature flag: embeddings = ['voyage-ai-client']",
        "Example: Document retrieval pipeline with Claude",
        "Example: RAG with embeddings + search_result blocks"
      ]
    },
    {
      "id": "SDK024",
      "name": "Context Editing / Prompt Stitching",
      "description": "Helper utilities for managing large context: truncation, summarization, sliding windows.",
      "priority": 3,
      "status": "planned",
      "dependencies": ["SDK008"],
      "notes": [
        "ConversationBuilder.with_context_limit(tokens)",
        "Auto-truncate old messages when limit reached",
        "Summarize old context before truncating (optional)",
        "Sliding window with overlap",
        "Requires token counting (SDK008) to be accurate"
      ]
    },
    {
      "id": "SDK025",
      "name": "Citations and Sources",
      "description": "Parse and track citations when Claude references sources. Useful for RAG applications.",
      "priority": 4,
      "status": "planned",
      "dependencies": ["SDK007"],
      "notes": [
        "Define citation format in system prompt",
        "Parse [source: X] or similar patterns",
        "Track which tools/documents influenced response",
        "Helper utilities for citation extraction",
        "Example: RAG with citation tracking"
      ]
    },
    {
      "id": "SDK026",
      "name": "Files API Support",
      "description": "Support for Claude's file upload/download API. Upload files once, reference by file_id. Beta: files-api-2025-04-14",
      "priority": 2,
      "status": "planned",
      "dependencies": ["SDK001"],
      "notes": [
        "API: POST /v1/files (upload), GET /v1/files (list), DELETE /v1/files/{id}",
        "Beta header: anthropic-beta: files-api-2025-04-14",
        "Max file size: 500 MB, storage limit: 100 GB per org",
        "Supported: Images, PDFs, text files, datasets",
        "Use with image/document content blocks",
        "Free to upload/download, charged as input tokens when used",
        "Only download files created by code execution tool",
        "Implement: FilesClient with upload/list/retrieve/delete/download"
      ]
    },
    {
      "id": "SDK030",
      "name": "Search Results Content Blocks",
      "description": "Support search_result content blocks for RAG applications with automatic citations.",
      "priority": 2,
      "status": "planned",
      "dependencies": ["SDK002"],
      "notes": [
        "Add SearchResult content block type",
        "Fields: source (URL), title, content (text blocks), citations (enabled)",
        "Use in: Tool results (dynamic RAG) or top-level (pre-fetched)",
        "Claude automatically cites sources when using search results",
        "Citation tracking: search_result_location with cited_text",
        "Supported in: Opus 4.5, Opus 4.1, Opus 4, Sonnet 4.5, Sonnet 4, Haiku 3.5",
        "Example: RAG with automatic source attribution"
      ]
    },
    {
      "id": "SDK031",
      "name": "Document Content Blocks",
      "description": "Support document content blocks for PDFs and text files via Files API.",
      "priority": 2,
      "status": "planned",
      "dependencies": ["SDK026"],
      "notes": [
        "Add Document content block type",
        "Source: file_id or base64",
        "Optional: title, context, citations.enabled",
        "Supported: PDF (application/pdf), plain text (text/plain)",
        "Use with Files API for avoid re-uploading",
        "Example: PDF analysis with citations"
      ]
    },
    {
      "id": "SDK027",
      "name": "Multilingual Optimization",
      "description": "Helpers for multilingual conversations: language detection, translation requests, locale handling.",
      "priority": 4,
      "status": "planned",
      "dependencies": ["SDK007"],
      "notes": [
        "Claude already supports all major languages",
        "Add helper: ConversationBuilder.with_language(locale)",
        "Add to system prompt: 'Respond in {language}'",
        "Example: Multi-language customer support bot",
        "No new API features needed, just conveniences"
      ]
    },
    {
      "id": "SDK028",
      "name": "Effort Parameter Support",
      "description": "Support for effort parameter to control thinking depth (if/when available).",
      "priority": 4,
      "status": "blocked",
      "dependencies": [],
      "notes": [
        "BLOCKED: Not in current API",
        "Monitor API changelog for effort parameter",
        "Would allow: Low/medium/high thinking effort",
        "Trade-off: Speed vs quality"
      ]
    },
    {
      "id": "SDK029",
      "name": "MCP (Model Context Protocol) Integration",
      "description": "Integration layer for MCP servers to provide tools and context to Claude. MCP is a protocol for connecting AI apps to external data sources.",
      "priority": 3,
      "status": "planned",
      "dependencies": ["SDK006", "SDK007"],
      "notes": [
        "MCP is separate from Claude SDK - it provides tools/data sources",
        "Integration approach: MCP server → Tool definitions → Claude SDK",
        "Create mcp module with McpTool trait",
        "Auto-convert MCP tools to Claude Tool format",
        "Handle MCP tool execution and result formatting",
        "Support stdio, SSE, and HTTP MCP transports",
        "Example: Connect to MCP filesystem server, use tools in conversation",
        "Colony Shell will heavily use this integration"
      ]
    }
  ],
  "mcp_integration_strategy": {
    "architecture": "Adapter pattern - MCP provides tools, SDK calls Claude",
    "layers": [
      "1. MCP Client (connects to MCP servers)",
      "2. Tool Adapter (converts MCP tools → Claude Tools)",
      "3. Execution Bridge (executes MCP tool calls)",
      "4. Claude SDK (sends requests with tools to Claude)"
    ],
    "implementation_plan": [
      "Phase 1: Define McpTool trait and conversion logic",
      "Phase 2: Implement MCP client (stdio, SSE, HTTP transports)",
      "Phase 3: Auto-execute MCP tools when Claude requests them",
      "Phase 4: Examples with popular MCP servers (filesystem, fetch, etc.)"
    ],
    "design_notes": [
      "MCP is NOT part of Claude API - it's an integration layer",
      "SDK should not depend on MCP - keep as optional feature",
      "Use feature flag: mcp = ['mcp-client-crate']",
      "Tool execution can be automatic or manual (user choice)",
      "Colony Shell will use SDK + MCP integration for agentic workflows"
    ]
  },

  "implementation_notes": {
    "immediate_priority": [
      "SDK019 (Vision) - Image blocks with base64/URL/file_id",
      "SDK026 (Files API) - Upload/download files, beta available",
      "SDK030 (Search results) - RAG with automatic citations",
      "SDK031 (Document blocks) - PDFs and text files",
      "SDK020 (Structured outputs) - tool_choice parameter"
    ],
    "medium_priority": [
      "SDK018 (Extended thinking) - Available with beta header",
      "SDK021 (Batch API) - Good for cost reduction",
      "SDK024 (Context editing) - Needs SDK008 first"
    ],
    "blocked_on_api": [
      "SDK023 (Embeddings) - Anthropic doesn't offer yet",
      "SDK028 (Effort parameter) - Not in API yet"
    ],
    "nice_to_have": [
      "SDK022 (PDF) - Built on document blocks",
      "SDK025 (Citations parsing) - Extract citations from responses",
      "SDK027 (Multilingual) - Just conveniences"
    ]
  }
}
